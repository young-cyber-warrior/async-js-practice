# –ú–æ–¥—É–ª—å 3: Async/Await

## üéØ –¶–µ–ª—å –º–æ–¥—É–ª—è

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üìù –ó–∞–¥–∞—á–∞ 13: –ë–∞–∑–æ–≤—ã–π async/await —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

### –û–ø–∏—Å–∞–Ω–∏–µ

–ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å —Ü–µ–ø–æ—á–∫—É –ø—Ä–æ–º–∏—Å–æ–≤ –Ω–∞ async/await —Å–∏–Ω—Ç–∞–∫—Å–∏—Å. –ù–∞—É—á–∏—Ç—å—Å—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –ø—Ä–æ–º–∏—Å—ã –≤ –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã–π –∫–æ–¥.

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–§—É–Ω–∫—Ü–∏—è —Å async/await –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –∏–¥–µ–Ω—Ç–∏—á–Ω–æ –≤–µ—Ä—Å–∏–∏ —Å –ø—Ä–æ–º–∏—Å–∞–º–∏
–ö–æ–¥ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã–º –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º
–§—É–Ω–∫—Ü–∏—è delay –¥–æ–ª–∂–Ω–∞ –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è

### –£—Å–ª–æ–≤–∏–µ

```javascript
function fetchUserData(userId) {
    return fetch(`/api/users/${userId}`)
        .then((response) => response.json())
        .then((user) => {
            return fetch(`/api/posts?userId=${user.id}`);
        })
        .then((response) => response.json())
        .then((posts) => {
            return fetch(`/api/comments?postId=${posts[0].id}`);
        })
        .then((response) => response.json())
        .catch((error) => {
            console.error('Error:', error);
            return null;
        });
}

async function fetchUserDataAsync(userId) {
    // –í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å
}

async function delay(ms) {
    // –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –∏—Å–ø–æ–ª—å–∑—É—è Promise –∏ setTimeout
}
```

---

## üìù –ó–∞–¥–∞—á–∞ 14: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ vs –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

### –û–ø–∏—Å–∞–Ω–∏–µ

–ü–æ–Ω—è—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º –∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º async –æ–ø–µ—Ä–∞—Ü–∏–π. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

### –£—Å–ª–æ–≤–∏–µ

```javascript
// API —Å–∏–º—É–ª—è—Ü–∏—è
const api = {
    getUser: (id) =>
        new Promise((resolve) =>
            setTimeout(() => resolve({ id, name: `User${id}` }), 1000)
        ),
    getPosts: (userId) =>
        new Promise((resolve) =>
            setTimeout(
                () => resolve([{ id: 1, userId, title: 'Post 1' }]),
                1000
            )
        ),
    getComments: (postId) =>
        new Promise((resolve) =>
            setTimeout(
                () => resolve([{ id: 1, postId, text: 'Comment' }]),
                1000
            )
        ),
};

// –ó–∞–¥–∞–Ω–∏–µ 1: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (–º–µ–¥–ª–µ–Ω–Ω–æ)
async function loadDataSequential(userIds) {
    const results = [];
    // TODO: –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
    // –ó–∞–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    return results;
}

// –ó–∞–¥–∞–Ω–∏–µ 2: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (–±—ã—Å—Ç—Ä–æ)
async function loadDataParallel(userIds) {
    // TODO: –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
    // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Promise.all
    return results;
}

// –ó–∞–¥–∞–Ω–∏–µ 3: –ß–∞—Å—Ç–∏—á–Ω–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
async function loadDataMixed(userId) {
    // TODO: –ó–∞–≥—Ä—É–∑–∏—Ç—å user, –∑–∞—Ç–µ–º –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ posts –∏ comments
    // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
}

// –ó–∞–¥–∞–Ω–∏–µ 4: Promise.allSettled –¥–ª—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∫ –æ—à–∏–±–∫–∞–º
async function loadDataResilient(userIds) {
    // TODO: –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã fail
    // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Promise.allSettled
}

// –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
async function benchmark() {
    const userIds = [1, 2, 3, 4, 5];

    console.time('Sequential');
    await loadDataSequential(userIds);
    console.timeEnd('Sequential');

    console.time('Parallel');
    await loadDataParallel(userIds);
    console.timeEnd('Parallel');
}
```

---

## üìù –ó–∞–¥–∞—á–∞ 15: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å try/catch

### –£—Å–ª–æ–≤–∏–µ

```javascript
// –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–µ API (50% —à–∞–Ω—Å –æ—à–∏–±–∫–∏) - –ù–ï –ò–ó–ú–ï–ù–Ø–¢–¨!
const unreliableAPI = {
    fetchData: async (id) => {
        if (Math.random() < 0.5) {
            throw new Error(`Failed to fetch data for id: ${id}`);
        }
        return { id, data: `Data for ${id}` };
    },
};
```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ó–∞–¥–∞–Ω–∏–µ 1: fetchWithErrorHandling
–ë–∞–∑–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:

–ü—Ä–∏–Ω–∏–º–∞–µ—Ç id
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç try/catch –¥–ª—è –≤—ã–∑–æ–≤–∞ unreliableAPI.fetchData(id)
–ü—Ä–∏ —É—Å–ø–µ—Ö–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–ü—Ä–∏ –æ—à–∏–±–∫–µ –ª–æ–≥–∏—Ä—É–µ—Ç –µ—ë –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç null
–ù–ï –¥–æ–ª–∂–Ω–∞ –≤—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å –æ—à–∏–±–∫—É –Ω–∞—Ä—É–∂—É

–ó–∞–¥–∞–Ω–∏–µ 2: fetchWithRetry
–ú–µ—Ö–∞–Ω–∏–∑–º –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ —Å exponential backoff:

–ü—Ä–∏–Ω–∏–º–∞–µ—Ç id –∏ maxRetries (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3)
–ü—Ä–∏ –æ—à–∏–±–∫–µ –ø—ã—Ç–∞–µ—Ç—Å—è –µ—â—ë —Ä–∞–∑, –º–∞–∫—Å–∏–º—É–º maxRetries —Ä–∞–∑
–ú–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏ –¥–µ–ª–∞–µ—Ç –∑–∞–¥–µ—Ä–∂–∫—É:

1-—è –ø–æ–ø—ã—Ç–∫–∞: –±–µ–∑ –∑–∞–¥–µ—Ä–∂–∫–∏
2-—è –ø–æ–ø—ã—Ç–∫–∞: 100ms –∑–∞–¥–µ—Ä–∂–∫–∞
3-—è –ø–æ–ø—ã—Ç–∫–∞: 200ms –∑–∞–¥–µ—Ä–∂–∫–∞
4-—è –ø–æ–ø—ã—Ç–∫–∞: 400ms –∑–∞–¥–µ—Ä–∂–∫–∞ (exponential backoff)

–ï—Å–ª–∏ –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –Ω–µ—É–¥–∞—á–Ω—ã - –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω—é—é –æ—à–∏–±–∫—É
–ü—Ä–∏ —É—Å–ø–µ—Ö–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ

–§–æ—Ä–º—É–ª–∞ –∑–∞–¥–µ—Ä–∂–∫–∏: delay = 100 \* Math.pow(2, attemptNumber - 2) –¥–ª—è attempt >= 2

–ó–∞–¥–∞–Ω–∏–µ 3: complexOperation
–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ try/catch –±–ª–æ–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏:

```javascript
async function complexOperation(userId) {
    let user, profile, settings;

    // TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É:
    // 1. user - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ô (–µ—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–∏ - –≤—ã–±—Ä–æ—Å–∏—Ç—å –æ—à–∏–±–∫—É)
    // 2. profile - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π (–ø—Ä–∏ –æ—à–∏–±–∫–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å defaultProfile)
    // 3. settings - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π (–ø—Ä–∏ –æ—à–∏–±–∫–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å defaultSettings)

    const defaultProfile = { bio: 'No profile', avatar: null };
    const defaultSettings = { theme: 'light', notifications: true };

    return { user, profile, settings };
}
```

–ó–∞–¥–∞–Ω–∏–µ 4: –ö–ª–∞—Å—Å RetryableError –∏ smartRetry
–°–æ–∑–¥–∞—Ç—å —É–º–Ω—É—é —Å–∏—Å—Ç–µ–º—É retry —Å —Ä–∞–∑–Ω—ã–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏:

```javascript
class RetryableError extends Error {
    constructor(message, retryAfter = 1000) {
        super(message);
        this.name = 'RetryableError';
        this.retryAfter = retryAfter; // —Å–∫–æ–ª—å–∫–æ –∂–¥–∞—Ç—å –ø–µ—Ä–µ–¥ retry
    }
}

async function smartRetry(fn, maxRetries = 3) {
    // TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É:
    // - –ï—Å–ª–∏ RetryableError - –∂–¥–∞—Ç—å —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è retryAfter
    // - –ï—Å–ª–∏ –æ–±—ã—á–Ω–∞—è Error - retry –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
    // - –ï—Å–ª–∏ –Ω–µ Error - –ø—Ä–æ–±—Ä–æ—Å–∏—Ç—å –¥–∞–ª—å—à–µ
    // - –í–µ—Å—Ç–∏ —Å—á—ë—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫
    // - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—É—é –ø–æ–ø—ã—Ç–∫—É
}
```

## üìù –ó–∞–¥–∞—á–∞ 16: Async –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ó–∞–¥–∞–Ω–∏–µ 1: numberGenerator
–°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–π async –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —á–∏—Å–µ–ª:

```javascript
async function* numberGenerator(max) {
    // TODO: –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —á–∏—Å–ª–∞ –æ—Ç 1 –¥–æ max
    // –ö–∞–∂–¥–æ–µ —á–∏—Å–ª–æ —á–µ—Ä–µ–∑ 100ms –∑–∞–¥–µ—Ä–∂–∫—É
    // yield –∫–∞–∂–¥–æ–µ —á–∏—Å–ª–æ
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
for await (const num of numberGenerator(5)) {
    console.log(num); // 1, 2, 3, 4, 5 (—Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –º–µ–∂–¥—É —á–∏—Å–ª–∞–º–∏)
}
```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ó–∞–¥–∞–Ω–∏–µ 2: paginatedFetch
–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–ª—è –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:

```javascript
async function* paginatedFetch(url, pageSize = 10) {
    let page = 1;
    let hasMore = true;

    while (hasMore) {
        // TODO: –ó–∞–≥—Ä—É–∂–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–∞–Ω–Ω—ã—Ö
        // –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å API –∑–∞–ø—Ä–æ—Å —Å await
        // yield —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–∞–Ω–Ω—ã—Ö
        // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã—Ö –±–æ–ª—å—à–µ –Ω–µ—Ç
        // –î–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π:
        // - –°—Ç—Ä–∞–Ω–∏—Ü—ã 1-5 –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –¥–∞–Ω–Ω—ã–µ
        // - –°—Ç—Ä–∞–Ω–∏—Ü–∞ 6+ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
for await (const page of paginatedFetch('/api/items')) {
    console.log('Page:', page);
    // –ú–æ–∂–Ω–æ –ø—Ä–µ—Ä–≤–∞—Ç—å –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
    if (someCondition) break;
}
```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ó–∞–¥–∞–Ω–∏–µ 3: eventStream
–ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ–±—ã—Ç–∏–π:

```javascript
async function* eventStream(eventSource) {
    // TODO: –°–æ–∑–¥–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–ª—è –ø–æ—Ç–æ–∫–∞ —Å–æ–±—ã—Ç–∏–π
    // –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –∫–∞–∂–¥—ã–µ 500ms
    // –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
    // –ü–æ–∑–≤–æ–ª–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫—É —á–µ—Ä–µ–∑ break –∏–ª–∏ return

    let eventId = 0;
    while (true) {
        // –°–∏–º—É–ª—è—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è
        // yield { id: eventId++, data: ..., timestamp: ... }
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
const stream = eventStream('wss://events');
for await (const event of stream) {
    console.log('Event:', event);
    if (event.id > 10) break; // –û—Å—Ç–∞–Ω–æ–≤–∫–∞
}
```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ó–∞–¥–∞–Ω–∏–µ 4: compose
–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤:

```javascript
async function* compose(...generators) {
    // TODO: –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ async –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤ –≤ –æ–¥–∏–Ω
    // –í—ã–¥–∞–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –≤—Å–µ—Ö –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
    // –ü—Ä–∏–º–µ—Ä:
    // gen1 yields: 1, 2, 3
    // gen2 yields: 'a', 'b'
    // compose(gen1, gen2) yields: 1, 2, 3, 'a', 'b'
}
```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ó–∞–¥–∞–Ω–∏–µ 5: filter –∏ map
–£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤:

```javascript
async function* filter(generator, predicate) {
    // TODO: –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
    // yield —Ç–æ–ª—å–∫–æ —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Ö–æ–¥—è—Ç predicate
}

async function* map(generator, transform) {
    // TODO: –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
    // yield —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
const numbers = numberGenerator(10);
const evens = filter(numbers, (n) => n % 2 === 0);
const doubled = map(evens, (n) => n * 2);

for await (const num of doubled) {
    console.log(num); // 4, 8, 12, 16, 20
}
```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ó–∞–¥–∞–Ω–∏–µ 6: rateLimitedGenerator
–ö–æ–Ω—Ç—Ä–æ–ª—å —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤—ã–¥–∞—á–∏ –∑–Ω–∞—á–µ–Ω–∏–π:

```javascript
async function* rateLimitedGenerator(generator, minDelay) {
    // TODO: –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –≤—ã–¥–∞—á–∏ –∑–Ω–∞—á–µ–Ω–∏–π
    // –ú–µ–∂–¥—É yield –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–π—Ç–∏ –º–∏–Ω–∏–º—É–º minDelay ms
    // –î–∞–∂–µ –µ—Å–ª–∏ –∏—Å—Ö–æ–¥–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –±—ã—Å—Ç—Ä–µ–µ
}
```

## üìù –ó–∞–¥–∞—á–∞ 17: For-await-of —Ü–∏–∫–ª—ã

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ó–∞–¥–∞—á–∞ 1: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∏—Ç–µ—Ä–∞—Ç–æ—Ä –¥–ª—è –º–∞—Å—Å–∏–≤–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
–†–µ–∞–ª–∏–∑—É–π —Ñ—É–Ω–∫—Ü–∏—é asyncArrayIterator(arr, delay), –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Å—Å–∏–≤ –∏ –∑–∞–¥–µ—Ä–∂–∫—É (–≤ –º—Å). –§—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∏—Ç–µ—Ä–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ for-await-of –±—É–¥–µ—Ç –≤—ã–¥–∞–≤–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Å—Å–∏–≤–∞ —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏.

–ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π –∫–æ–¥:

```javascript
async function testAsyncArrayIterator() {
    const arr = [1, 2, 3];
    const delay = 100;
    const result = [];
    const start = Date.now();
    for await (const item of asyncArrayIterator(arr, delay)) {
        result.push(item);
    }
    const duration = Date.now() - start;
    console.log(
        result.join(',') === '1,2,3' && duration >= delay * arr.length
            ? '‚úÖ Passed'
            : '‚ùå Failed'
    );
}
testAsyncArrayIterator();
```

## üìù –ó–∞–¥–∞—á–∞ 19: Top-level await

Top-level await –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å await –≤ –∫–æ—Ä–Ω–µ –º–æ–¥—É–ª—è –±–µ–∑ –æ–±—ë—Ä—Ç–∫–∏ –≤ async —Ñ—É–Ω–∫—Ü–∏—é. –≠—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º –∫–æ–¥–æ–º –≤ –º–æ–¥—É–ª—è—Ö.

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ó–∞–¥–∞—á–∞ 1:
–°–æ–∑–¥–∞–π –º–æ–¥—É–ª—å, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é top-level await
–ò—Å–ø–æ–ª—å–∑—É–π fetch() –∏–ª–∏ —Å–∏–º—É–ª—è—Ü–∏—é –∑–∞–¥–µ—Ä–∂–∫–∏ —Å setTimeout
–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

–ó–∞–¥–∞—á–∞ 2:
–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:

–û–±—Ä–∞–±–æ—Ç–∞–π –æ—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–æ–¥—É–ª—è —Å try/catch
–ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å fallback –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–µ
–õ–æ–≥–∏—Ä—É–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–≥—Ä—É–∑–∫–µ

–ó–∞–¥–∞—á–∞ 4:
–£—Å–ª–æ–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞:

–ó–∞–≥—Ä—É–∂–∞–π –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ —É—Å–ª–æ–≤–∏—è
–ò—Å–ø–æ–ª—å–∑—É–π –æ–∫—Ä—É–∂–∞—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥
–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π —Ñ–ª–∞–≥ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

## üìù –ó–∞–¥–∞—á–∞ 20: Async —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã—Å—à–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞

–ü—Ä–∏–Ω–∏–º–∞—é—Ç –¥—Ä—É–≥–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç—ã
–í–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ñ—É–Ω–∫—Ü–∏–∏
–†–∞–±–æ—Ç–∞—é—Ç —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º –∫–æ–¥–æ–º

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ó–∞–¥–∞—á–∞ 1:
–°–æ–∑–¥–∞–π –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã—Å—à–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞:

withTimeout(asyncFn, ms) ‚Äî –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–æ–ª—å—à–µ ms, –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É "Timeout"

–ó–∞–¥–∞—á–∞ 2:
–°–æ–∑–¥–∞–π —Ñ—É–Ω–∫—Ü–∏—é withCache(asyncFn):

–ü—Ä–∏–Ω–∏–º–∞–µ—Ç async —Ñ—É–Ω–∫—Ü–∏—é
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –∫–µ—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
–ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—é –≤—ã–∑–≤–∞–ª–∏ —Å —Ç–µ–º–∏ –∂–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑ –∫–µ—à–∞
–ï—Å–ª–∏ —Å –Ω–æ–≤—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –∑–∞–Ω–æ–≤–æ

–ó–∞–¥–∞—á–∞ 3:
–°–æ–∑–¥–∞–π —Ñ—É–Ω–∫—Ü–∏—é withConcurrencyLimit(asyncFn, limit):

–ü—Ä–∏–Ω–∏–º–∞–µ—Ç async —Ñ—É–Ω–∫—Ü–∏—é –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π
–ï—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω–æ —É–∂–µ limit —Ñ—É–Ω–∫—Ü–∏–π, –Ω–æ–≤—ã–µ –∂–¥—É—Ç –≤ –æ—á–µ—Ä–µ–¥–∏
–ö–æ–≥–¥–∞ –æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è, —Å–ª–µ–¥—É—é—â–∞—è –∏–∑ –æ—á–µ—Ä–µ–¥–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è
